{% extends "dashboard.html" %}

{% block content %}



<div class="card p-2">
  
  <!-- add item modal -->
  <div class="modal fade" id="addItem" data-bs-backdrop="static" >
    <div class="modal-dialog modal-content" >
      <div class="modal-header border-0 fw-bold"> Add Item Card </div>
      <form action="" method="post" >
        <div class="modal-body">
          <label for="">name</label>
          <input type="text" name="name" class="form-control"  required minlength="4" maxlength="30" >
          <label for="">price</label>
          <input type="number" name="price" class="form-control"  required min="1">
          <div name="stock_field">
            <label for="">stock</label>
            <input type="number" name="stock" class="form-control"  min="1">
          </div>
          <label for="">description</label>
          <textarea type="text" name="description" class="form-control" ></textarea>
          <label for="">cartegory</label>
          <select name="cartegory" id="" class="form-select" >
            <option value="" selected disabled>select cartegory</option>
            {% if cartegories != None %}
                {% for item in cartegories%}
                <option value="{{item}}">{{item}}</option>
                {% endfor%}
            {% endif %}
          </select> 
          <label for="">photo</label>
          <input type="file" name="photo" class="form-control"  >
        </div>
        <div class="modal-footer justify-content-between">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">cancel</button>
          <button type="submit" class="btn btn-primary">submit</button>
        </div>
      </form>
    </div>
  </div>

  <table class="table">
    <thead class="">
      <tr class="bg-light m-2">
        <th scope="col">#</th>
        <th scope="col">item</th>
        <th scope="col">price</th>
        <th scope="col" name="stock_field">stock</th>
        <th scope="col">cartegory</th>
        <th scope="col">active</th>
        <th scope="col">actions</th>
        <th> <button class="btn btn-primary" data-bs-target="#addItem" data-bs-toggle="modal" >add new </button></th>
      </tr>

    </thead>
    <tbody class="">
      {% for item in items%}

      <!-- update item modal for each item -->
      <div class="modal fade" id="itemDialog-{{item.id}}">
        <div class="modal-dialog modal-content">
          <div class="modal-header border-0 fw-bold"> Item Card </div>
          <form action="/{{item.type}}/{{item.id}}" method="post">
            <div class="modal-body">
              <label for="">name</label>
              <input type="text" name="name" class="form-control" value="{{item.name}}" required minlength="4" maxlength="30">
              <label for="">price</label>
              <input type="number" name="price" class="form-control" value="{{item.price}}" required min="1">
              {% if item.type=="product" %}
                <label for="">stock</label>
                <input type="number" name="stock" class="form-control" value="{{item.stock}}" required min="1">
              {% endif %}
              <label for="">description</label>
              <textarea type="text" name="description" class="form-control"  >{{item.description}}</textarea>
              <label for="" class="text-muted mt-2">is active</label>
              <input type="checkbox" class="m-3" name="active"  {% if item.active %} checked="{{item.value}}" {% endif %} id="">
              <br>
              <select name="cartegory" id="" class="form-select" >
                <option value="{{item.cartegory}}" selected disabled>select cartegory</option>
                {% if cartegories != None %}
                    {% for item in cartegories%}
                    <option value="{{item}}">{{item}}</option>
                    {% endfor%}
                {% endif %}
              </select> 
              <label for="">photo</label>
              <input type="file" name="photo" class="form-control" value="{{item.photo}}">

            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">cancel</button>
              <button type="submit" class="btn btn-primary">submit</button>
            </div>
          </form>

        </div>
      </div>

      <!-- delete item modal for each item -->
      <div class="modal fade" id="deleteDialog-{{item.id}}">
        <div class="modal-dialog modal-content modal-sm">
          <div class="modal-header border-0 fw-bold">{{item.name}}</div>
          <div class="modal-body text-muted">are you sure you want to delete this item</div>
          <div  class="modal-footer justify-content-between">
            <button class="btn btn-outline-dark rounded-pill" data-bs-dismiss="modal">cancel</button>
            <a href="/delete/{{item.type}}/{{item.id}}" class="btn btn-danger rounded-pill">delete</a>
          </div>
        </div>
      </div>
      
      <!-- item row in the table -->
      <tr class="m-2 shadow rounded border-secondary-subtle" data-bs-target="#itemDialog-{{item.id}}"
        data-bs-toggle="modal">
        <th scope="row">{{item.id}}</th>
        <td>{{item.name}}</td>
        <td>{{item.price}}</td>
        {% if item.type=="product" %}
          <td>{{item.stock}}</td>
        {% endif %}
        <td>{{item.cartegory}}</td>
        <td>{{item.active}}</td>
        <td class="btn-group" role="group"></a>
          <button class="btn btn-primary">update</button>
          <button  class="btn btn-danger"  data-bs-target="#deleteDialog-{{item.id}}" data-bs-toggle="modal">delete</a>
        </td>
      </tr>
      {% endfor %}

    </tbody>
  </table>
</div>

<script> 
  const url=window.location.href;
  if(url.includes('service')){
    const items=document.getElementsByName('stock_field');
    items.forEach(element => {
      element.style.display='none'
      element.required=false;
    });
  }
</script>

{% endblock %}